
# 日志链路和收集

# 日志收集

* 如果不计较成本，那么可以直接使用商用消息队列组件，不需要考虑高可用等运维情况
* 如果考虑成本，可以自建消息队列服务，且需要考虑消息服务不可用的情况：比如不可用的时候生成日志文件，并及时告知管理员恢复相关服务运行


# 线上联调
是否可以指定特定流量的请求到某个服务器？

比如，在网关阶段，只把联调测试人员的相关请求分发到分析所用的那台服务器？
原因是，第一，在测试所用的这台服务器，可以开启debug级别的日志级别；
第二，在没有其他人员请求的情况下，更容易监控相关日志信息。
（但如果日志链路收集做好之后，根据traceId也能比较容易的找到相关日志）

那么需要解决的问题：
* 检测到相关用户对应的session
* 找到开启DEBUG的测试服务器，并能够将相关请求转发过去

# 日志分表

* 按照日期分表
* 如果日期分表也不能满足需求
    - 按照traceId哈希分表
    - 按照各表中的存储数量自动转换到新表


# 参考
* [可观测性也“卷”起来了！过去十年，我们在阿里云如何建设可观测体系？ | 卓越技术团队访谈录](https://www.infoq.cn/article/jgzBEmozGmBsUKeWFf6J)








